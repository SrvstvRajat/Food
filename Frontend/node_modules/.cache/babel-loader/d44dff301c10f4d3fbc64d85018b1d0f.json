{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Rajat/Desktop/My Projects/Swato/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/Rajat/Desktop/My Projects/Swato/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/Rajat/Desktop/My Projects/Swato/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from'react';import axios from'axios';import{useHistory}from'react-router';import{jsx as _jsx}from\"react/jsx-runtime\";export var AuthContext=/*#__PURE__*/React.createContext();//custom hook that allows components to access context data\nexport function useAuth(){return useContext(AuthContext);}function AuthProvider(_ref){var children=_ref.children;var history=useHistory();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),user=_useState2[0],userSet=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];function signUp(_x,_x2,_x3,_x4){return _signUp.apply(this,arguments);}function _signUp(){_signUp=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(name,email,password,confirmPassword){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.post(\"/user/signup\",{name:name,email:email,password:password,confirmPassword:confirmPassword});case 2:console.log(\"rftgyhujikolpoygtfftgyhuj\");console.log(name);userSet(user);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return _signUp.apply(this,arguments);}function login(_x5,_x6){return _login.apply(this,arguments);}function _login(){_login=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(email,password){var data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.post(\"/user/login\",{email:email,password:password});case 3:data=_context3.sent;console.log(data);userSet(data);localStorage.setItem(\"user\",JSON.stringify(data.data));return _context3.abrupt(\"return\",data);case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);case 13:case\"end\":return _context3.stop();}}},_callee3,null,[[0,10]]);}));return _login.apply(this,arguments);}function logout(){return _logout.apply(this,arguments);}function _logout(){_logout=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:localStorage.removeItem(\"user\");_context4.next=3;return axios.get(\"/user/logout\");case 3:data=_context4.sent;history.push(\"/\");console.log(data);userSet(null);case 7:case\"end\":return _context4.stop();}}},_callee4);}));return _logout.apply(this,arguments);}useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:data=localStorage.getItem(\"user\");console.log(data,898787);if(data){userSet(JSON.parse(data));console.log(user);history.push(\"/\");}else{userSet(null);}case 3:case\"end\":return _context.stop();}}},_callee);})),[]);var value={user:user,login:login,signUp:signUp,logout:logout};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:!loading&&children});}export default AuthProvider;","map":{"version":3,"names":["React","useState","useEffect","useContext","axios","useHistory","AuthContext","createContext","useAuth","AuthProvider","children","history","user","userSet","loading","setLoading","signUp","name","email","password","confirmPassword","post","console","log","login","data","localStorage","setItem","JSON","stringify","logout","removeItem","get","push","getItem","parse","value"],"sources":["C:/Users/Rajat/Desktop/My Projects/Swato/Frontend/src/Components/Context/AuthProvider.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\r\nimport axios from 'axios';\r\nimport { useHistory } from 'react-router';\r\n\r\nexport const AuthContext = React.createContext();\r\n//custom hook that allows components to access context data\r\nexport function useAuth() {\r\n    return useContext(AuthContext)\r\n}\r\nfunction AuthProvider({ children }) {\r\n    const history = useHistory();\r\n    const [user, userSet] = useState(\"\");\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    async function signUp(name,email,password,confirmPassword) \r\n    {\r\n        await axios.post(\"/user/signup\",{\r\n            name:name,\r\n            email: email,\r\n            password: password,\r\n            confirmPassword:confirmPassword\r\n        });\r\n        console.log(\"rftgyhujikolpoygtfftgyhuj\")\r\n        console.log(name);\r\n        userSet(user);\r\n    }\r\n    async function login(email, password) {\r\n        try {\r\n            const data = await axios.post(\"/user/login\", {\r\n                email: email,\r\n                password: password\r\n            });\r\n            console.log(data);\r\n            userSet(data);\r\n            localStorage.setItem(\"user\", JSON.stringify(data.data));\r\n            return data;\r\n        }\r\n        catch (err) {\r\n            console.log(err);\r\n        }\r\n    }\r\n    async function logout() \r\n    {\r\n        localStorage.removeItem(\"user\")\r\n        const data = await axios.get(\"/user/logout\");\r\n        history.push(\"/\");\r\n        console.log(data);\r\n        userSet(null);\r\n    }\r\n\r\n    useEffect(async () => {\r\n        let data = localStorage.getItem(\"user\");\r\n        console.log(data,898787);\r\n        if (data) {\r\n            userSet(JSON.parse(data));\r\n            console.log(user);\r\n            history.push(\"/\");\r\n        } else {\r\n            userSet(null);\r\n        }\r\n    }, [])\r\n\r\n    const value = {\r\n        user,\r\n        login,\r\n        signUp,\r\n        logout\r\n    }\r\n\r\n    return (\r\n        < AuthContext.Provider value={value} >\r\n            {!loading && children}\r\n        </AuthContext.Provider >\r\n    )\r\n}\r\n\r\nexport default AuthProvider\r\n"],"mappings":"qfAAA,MAAOA,MAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,CAAqCC,UAArC,KAAuD,OAAvD,CACA,MAAOC,MAAP,KAAkB,OAAlB,CACA,OAASC,UAAT,KAA2B,cAA3B,C,2CAEA,MAAO,IAAMC,YAAW,cAAGN,KAAK,CAACO,aAAN,EAApB,CACP;AACA,MAAO,SAASC,QAAT,EAAmB,CACtB,MAAOL,WAAU,CAACG,WAAD,CAAjB,CACH,CACD,QAASG,aAAT,MAAoC,IAAZC,SAAY,MAAZA,QAAY,CAChC,GAAMC,QAAO,CAAGN,UAAU,EAA1B,CACA,cAAwBJ,QAAQ,CAAC,EAAD,CAAhC,wCAAOW,IAAP,eAAaC,OAAb,eACA,eAA8BZ,QAAQ,CAAC,KAAD,CAAtC,yCAAOa,OAAP,eAAgBC,UAAhB,eAHgC,QAKjBC,OALiB,0IAKhC,kBAAsBC,IAAtB,CAA2BC,KAA3B,CAAiCC,QAAjC,CAA0CC,eAA1C,6IAEUhB,MAAK,CAACiB,IAAN,CAAW,cAAX,CAA0B,CAC5BJ,IAAI,CAACA,IADuB,CAE5BC,KAAK,CAAEA,KAFqB,CAG5BC,QAAQ,CAAEA,QAHkB,CAI5BC,eAAe,CAACA,eAJY,CAA1B,CAFV,QAQIE,OAAO,CAACC,GAAR,CAAY,2BAAZ,EACAD,OAAO,CAACC,GAAR,CAAYN,IAAZ,EACAJ,OAAO,CAACD,IAAD,CAAP,CAVJ,wDALgC,iDAiBjBY,MAjBiB,gIAiBhC,kBAAqBN,KAArB,CAA4BC,QAA5B,uKAE2Bf,MAAK,CAACiB,IAAN,CAAW,aAAX,CAA0B,CACzCH,KAAK,CAAEA,KADkC,CAEzCC,QAAQ,CAAEA,QAF+B,CAA1B,CAF3B,QAEcM,IAFd,gBAMQH,OAAO,CAACC,GAAR,CAAYE,IAAZ,EACAZ,OAAO,CAACY,IAAD,CAAP,CACAC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAA6BC,IAAI,CAACC,SAAL,CAAeJ,IAAI,CAACA,IAApB,CAA7B,EARR,iCASeA,IATf,+DAYQH,OAAO,CAACC,GAAR,eAZR,uEAjBgC,gDAgCjBO,OAhCiB,4HAgChC,iJAEIJ,YAAY,CAACK,UAAb,CAAwB,MAAxB,EAFJ,uBAGuB3B,MAAK,CAAC4B,GAAN,CAAU,cAAV,CAHvB,QAGUP,IAHV,gBAIId,OAAO,CAACsB,IAAR,CAAa,GAAb,EACAX,OAAO,CAACC,GAAR,CAAYE,IAAZ,EACAZ,OAAO,CAAC,IAAD,CAAP,CANJ,wDAhCgC,yCAyChCX,SAAS,sEAAC,4IACFuB,IADE,CACKC,YAAY,CAACQ,OAAb,CAAqB,MAArB,CADL,CAENZ,OAAO,CAACC,GAAR,CAAYE,IAAZ,CAAiB,MAAjB,EACA,GAAIA,IAAJ,CAAU,CACNZ,OAAO,CAACe,IAAI,CAACO,KAAL,CAAWV,IAAX,CAAD,CAAP,CACAH,OAAO,CAACC,GAAR,CAAYX,IAAZ,EACAD,OAAO,CAACsB,IAAR,CAAa,GAAb,EACH,CAJD,IAIO,CACHpB,OAAO,CAAC,IAAD,CAAP,CACH,CATK,sDAAD,GAUN,EAVM,CAAT,CAYA,GAAMuB,MAAK,CAAG,CACVxB,IAAI,CAAJA,IADU,CAEVY,KAAK,CAALA,KAFU,CAGVR,MAAM,CAANA,MAHU,CAIVc,MAAM,CAANA,MAJU,CAAd,CAOA,mBACI,KAAE,WAAF,CAAc,QAAd,EAAuB,KAAK,CAAEM,KAA9B,UACK,CAACtB,OAAD,EAAYJ,QADjB,EADJ,CAKH,CAED,cAAeD,aAAf"},"metadata":{},"sourceType":"module"}